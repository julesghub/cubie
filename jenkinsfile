#!groovy

pipeline {
  agent {
      docker { 
        image 'underworldcode/underworld2:latest'
        label 'slave'
      }
  }

  stages {

    stage('Build') {
      steps {
        sh 'env'
        sh 'ls -lhtr'
        sh 'make'
        
          /*dir("./libUnderworld") {
            sh 'python configure.py'
            sh 'python compile.py'
          }*/
      }
    }
      
    stage('Run') {
      steps {
        sh './go -l 11 -d -6 -r 10 -i 5'
      }
      post {
        failure {
          echo "Post section of Run: It failed!"
          script {
            currentBuild.result = "SUCCESS"
          }
        } 
      }
    }


    stage('Go Up a Directory') {
      steps {
          dir("${WORKSPACE}") { 
            sh 'ls -lhtr' 
          }
      }
    }
  }
  
  post {
    success {
      echo "This is success"
    }
    failure {
      echo "This is failure"
    }
  }
}
